#:import HOME_SCREEN cilantro_audit.constants.HOME_SCREEN
#:import CREATE_AUDIT_PAGE cilantro_audit.constants.CREATE_AUDIT_PAGE
#:import COMPLETED_AUDITS_LIST_PAGE cilantro_audit.constants.COMPLETED_AUDITS_LIST_PAGE
#:import VIEW_FLAG_TRENDS_PAGE cilantro_audit.constants.VIEW_FLAG_TRENDS_PAGE

<AdminPage>:

    FloatLayout:

        Label:
            text: 'Admin Page'
            font_size: 40
            pos: 0, 150

        FloatLayout:

            pos_hint: {"center_x": 0.5, "center_y": 0.5}
            size_hint: None, None

            Button:
                text: "Create Audit"
                font_size: 25
                size: 250, 100
                size_hint: None, None
                pos_hint: {"center_x": -0.8, "center_y": 1.1}
                on_press: root.manager.current = 'CreateAuditTemplatePage'

            Button:
                text: "Clear All Audit Locks"
                font_size: 25
                size: 250, 100
                size_hint: None, None
                pos_hint: {"center_x": 1.7, "center_y": 1.1}
                on_press: root.clear_all_locks()

            Button:
                text: "View Submitted \nAudits"
                align: 'center'
                font_size: 25
                size: 250, 100
                size_hint: None, None
                pos_hint: {"center_x": -0.8, "center_y": 0.1}
                on_release:
                    root.manager.current = COMPLETED_AUDITS_LIST_PAGE
                    root.manager.get_screen(COMPLETED_AUDITS_LIST_PAGE).load_completed_audits()

            Button:
                text: "View Flag Trends"
                font_size: 25
                size: 250, 100
                size_hint: None, None
                pos_hint: {"center_x": 1.7, "center_y": 0.1}
                on_release:
                    root.manager.current = VIEW_FLAG_TRENDS_PAGE
                    root.manager.transition.duration = 0.3
                    root.manager.transition.direction = 'left'

            Button:
                text: "Return To Homepage"
                font_size: 25
                size: 250, 100
                size_hint: None, None
                pos_hint: {"center_x": -0.8, "center_y": -.9}
                on_press: root.manager.current = HOME_SCREEN

            Button:
                text: "Reset Password"
                font_size: 25
                size: 250, 100
                size_hint: None, None
                pos_hint: {"center_x": 1.7, "center_y": -.9}
                on_press: root.open_reset_password_popup()


        Button:
            text: "Exit"
            font_size: 30
            size: 300, 100
            size_hint: None, None
            pos_hint:{"center_x": 0.5}
            on_release:
                exit()


<TemplatesUnlockedPop>:
    title: "Task Completed"
    size_hint: .5, .5

    FloatLayout:

        Label:
            text: "All audit locks cleared; All audits available for submission."
            size_hint: 0.6, 0.2
            pos_hint: {"x": .2, "top": .9}

        Button:
            text: "OK"
            size_hint: .3, .3
            pos_hint: {"center_x": .5, "y": 0}
            on_press: root.dismiss()

<ResetPasswordPopup>
    id: popup
    auto_dismiss: True
    title: "Reset Admin Password"
    size_hint: None, None
    size: 400, 400

    GridLayout:
        rows: 7

        Label:
            text: "Current Password"

        TextInput:
            id: current_password_input
            focus: False
            password: True
            multiline: False
            size: 375, 30
            size_hint: None, None
            on_text_validate: root.validate_password(self.text)

        Label:
            text: "New Password"

        TextInput:
            id: new_password_input1
            focus: False
            password: True
            multiline: False
            size: 375, 30
            size_hint: None, None
            on_text_validate: root.validate_password(self.text)

        Label:
            text: "New Password (Again)"

        TextInput:
            id: new_password_input2
            focus: False
            password: True
            multiline: False
            size: 375, 30
            size_hint: None, None
            on_text_validate: root.validate_password(self.text)



        GridLayout:
            rows: 1
            cols: 2

            Button:
                text: "Cancel"
                font_size: 30
                size: 187.5, 30
                size_hint: None, None
                on_release:
                    root.dismiss()

            Button:
                text: "Submit"
                font_size: 30
                size: 187.5, 30
                size_hint: None, None
                on_release:
                    root.validate_password(root.content.children[1].text)
